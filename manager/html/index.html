<!DOCTYPE html>
<html>
<head>
<title>MQTT Manager</title>

<style>
    body {
        width: 35em;
        margin: 0 auto;
        font-family: Tahoma, Verdana, Arial, sans-serif;
    }
</style>

<script type="text/javascript">

function getOnlineNum() {
    alert('online')
}

function getClientList() {
	var xhr = new XMLHttpRequest();
     
    xhr.open("GET", "http://127.0.0.1:9000/getClientList?start=0&limit=5", true);
    xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");
    xhr.onreadystatechange = function(){
        
        var XMLHttpReq = xhr;
        /**
            XMLHttpReq.readyState
         0: 请求未初始化
         1: 服务器连接已建立
         2: 请求已接收
         3: 请求处理中
         4: 请求已完成，且响应已就绪
        **/
        if (XMLHttpReq.readyState == 4) {
			console.log(XMLHttpReq.status);
            if (XMLHttpReq.status == 200) {                
                var data = XMLHttpReq.responseText;
                alert(data)
                console.log(data);
                var json = JSON.parse(JSON.parse(data));
            }else if(XMLHttpReq.status == 100){
            
            }else if(XMLHttpReq.status == 300){
            
            }else if(XMLHttpReq.status == 400){
            
            }else if(XMLHttpReq.status == 500){
            
            }else if(XMLHttpReq.status == 0){
                /** 0不是http协议的状态,关于XMLHttpReq.status的说明:
                1、If the state is UNSENT or OPENED, return 0.（如果状态是UNSENT或者OPENED，返回0）
                2、If the error flag is set, return 0.（如果错误标签被设置，返回0）
                3、Return the HTTP status code.（返回HTTP状态码）
                第一种情况,例如:url请求的是本地文件,状态会是0
                第二种情况经常出现在跨域请求中,比如url不是本身网站IP或域名,例如请求www.baidu.com时
                第三种,正常请求本站http协议信息时,正常返回http协议状态值
                **/
            }
            
        }
    };
    xhr.send();
}

</script>
</head>
<body>

<div>
	<ul class="nav">
		<li><a href="javascript:getOnlineNum()">在线人数</a></li>
		<li><a href="javascript:getClientList()">注册人数</a></li>
	</ul>
</div>

</body>
</html>
